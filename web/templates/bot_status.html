{% extends "base.html" %}

{% block title %}æ©Ÿå™¨äººç‹€æ…‹ - É¢Ê€á´ æˆ°éšŠç®¡ç†ç³»çµ±{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
        <h2><i class="fas fa-heartbeat"></i> æ©Ÿå™¨äººç‹€æ…‹</h2>
    </div>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card text-white bg-success">
            <div class="card-header">ç‹€æ…‹</div>
            <div class="card-body">
                <h4 id="status">ğŸŸ¢ åœ¨ç·š</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-info">
            <div class="card-header">å»¶é²</div>
            <div class="card-body">
                <h4 id="latency">-- ms</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-warning">
            <div class="card-header">ä¼ºæœå™¨</div>
            <div class="card-body">
                <h4 id="guilds">-- å€‹</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card text-white bg-primary">
            <div class="card-header">æˆå“¡</div>
            <div class="card-body">
                <h4 id="members">-- äºº</h4>
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header bg-primary text-white">
        <h5>è©³ç´°è³‡è¨Š</h5>
    </div>
    <div class="card-body">
        <table class="table">
            <tr>
                <td><strong>æ©Ÿå™¨äººåç¨±</strong></td>
                <td id="botName">--</td>
            </tr>
            <tr>
                <td><strong>æ©Ÿå™¨äºº ID</strong></td>
                <td id="botId">--</td>
            </tr>
            <tr>
                <td><strong>ç™»å…¥æ™‚é–“</strong></td>
                <td id="loginTime">--</td>
            </tr>
            <tr>
                <td><strong>é‹è¡Œæ™‚é–“</strong></td>
                <td id="uptime">--</td>
            </tr>
        </table>
    </div>
</div>

<script>
function refreshStatus() {
    fetch('/api/bot/status')
        .then(res => res.json())
        .then(data => {
            document.getElementById('status').textContent = data.online ? 'ğŸŸ¢ åœ¨ç·š' : 'ğŸ”´ é›¢ç·š';
            document.getElementById('latency').textContent = Math.round(data.latency * 1000) + ' ms';
            document.getElementById('guilds').textContent = data.guild_count + ' å€‹';
            document.getElementById('members').textContent = data.member_count + ' äºº';
            document.getElementById('botName').textContent = data.name || '--';
            document.getElementById('botId').textContent = data.id || '--';
            document.getElementById('loginTime').textContent = new Date().toLocaleString('zh-TW');
        });
}

refreshStatus();
setInterval(refreshStatus, 5000); // æ¯ 5 ç§’æ›´æ–°ä¸€æ¬¡
</script>
{% endblock %}
